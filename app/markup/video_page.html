<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Videotesti 5</title>
</head>

<body>

<h1>Videotesti 5</h1>

<table border="0">
<tr>
  <td width="800">
    <div>
<video id="myvideo" width="800" controls>
    <source id="myvideo_source" src="" type="video/mp4"></source>
    Your browser does not support HTML5 video.</video>
<table>
  <tr>
    <td>
      <p>
        <button id="jump"><span id="play_utterance">Play utterance</span></button>
      </p>
      <p>
        <button id="playme"><span id="play_pause_video">Play/Pause Video</span></button>
      </p>
    </td>
    <td>
      <form>
	<input type="radio" id="stop" name="stop_or_continue" value="Stop" checked><span id="stop_playing_at_utterance_end">Stop playing at utterance end</span><br>
	<input type="radio" id="continue" name="stop_or_continue" value="Continue"><span id="continue_playing_after_utterance_end">Continue playing after utterance end</span><br>
      </form>
    </td>
  </tr>
</table>
    </div>

<script>

var myvideo = document.getElementById('myvideo');
var playbutton = document.getElementById('playme');
var jumplink = document.getElementById('jump');
  
var params = new URLSearchParams(document.location.search.substring(1));

var lang = params.get("lang");

if (lang == "fi")
{
document.getElementById("play_pause_video").innerHTML = "Soita/Pys채yt채 Video";
document.getElementById("play_utterance").innerHTML = "Soita puhunnos";
document.getElementById("stop_playing_at_utterance_end").innerHTML = "Lopeta puhunnoksen loppuun";
document.getElementById("continue_playing_after_utterance_end").innerHTML = "Jatka puhunnoksen j채lkeen";
}
else if (lang == "sv")
{
document.getElementById("play_pause_video").innerHTML = "Play/Pause Video (sv)";
document.getElementById("play_utterance").innerHTML = "Play utterance (sv)";
document.getElementById("stop_playing_at_utterance_end").innerHTML = "Stop playing at utterance end (sv)";
document.getElementById("continue_playing_after_utterance_end").innerHTML = "Continue playing after utterance end (sv)";
}

var src_url = params.get("src");
var corpusname = params.get("corpusname");
var metadata_urn = params.get("metadata_urn");
var korp_url = params.get("korp_url");
var utterance = params.get("utterance");

var text_attributes = params.get("text_attributes");
var attr = JSON.parse(text_attributes);

var speaker = "";
var speaker_parl_group = "";
var speaker_role = "";
var speech_type = "";
var begin_time = "";
var end_time = "";
var duration = "";
var published_date = "";
var published_time = "";
<!-- todo: session duration -->

for (var key in attr)
{

var unloc = key;
var attrValue = attr[key];
var loc_and_val = attrValue.split(",");

if (unloc == "paragraph_speaker") { speaker = loc_and_val; }
else if (unloc == "paragraph_speaker_parl_group") { speaker_parl_group = loc_and_val; }
else if (unloc == "paragraph_speaker_role" ) { speaker_role = loc_and_val; }
else if (unloc == "paragraph_speech_type" ) { speech_type = loc_and_val; }
else if (unloc == "utterance_begin_time" ) { begin_time = loc_and_val; }
else if (unloc == "utterance_end_time" ) { end_time = loc_and_val; }
else if (unloc == "utterance_duration" ) { duration = loc_and_val; }
else if (unloc == "text_date" ) { published_date = loc_and_val; }
else if (unloc == "text_time" ) { published_time = loc_and_val; }
<!-- todo: session duration -->

}

var source_elem = document.getElementById('myvideo_source');
source_elem.setAttribute("src", src_url);
myvideo.currentTime = begin_time[1];

var utterance_loc = "";
if (lang == "fi") { utterance_loc = "Puhunnos"; }
else if (lang == "sv") { utterance_loc = "Utterance (sv)"; }
else { utterance_loc = "Utterance"; }
document.write("<p><b>" + utterance_loc + ":</b> " + utterance + "</p>");

document.write("<p><b>" + speaker[0] + ":</b> " + speaker[1] + "</p>");
document.write("<p><b>" + speaker_parl_group[0] + ":</b> " + speaker_parl_group[1] + "</p>");
document.write("<p><b>" + speaker_role[0] + ":</b> " + speaker_role[1] + "</p>");
document.write("<p><b>" + speech_type[0] + ":</b> " + speech_type[1] + "</p>");

var sec = "";
if (lang == "fi") { sec = "sekuntia"; }
else if (lang == "sv") { sec = "seconds (sv)"; }
else { sec = "seconds"; }

document.write("<p>" + begin_time[0] + ": " + begin_time[1] + " " + sec + "</p>");
document.write("<p>" + end_time[0] + ": " + end_time[1] + " " + sec + "</p>");
document.write("<p>" + duration[0] + ": " + duration[1] + " " + sec + "</p>");

document.write('</td><td style="vertical-align:top">');

document.write('<div style="border:1px solid black;">')

var external_media_stream_loc = "";
if (lang == "fi") { external_media_stream_loc = "Ulkoinen media"; }
else if (lang == "sv") { external_media_stream_loc = "External media stream (sv)"; }
else { external_media_stream_loc = "External media stream"; }

var corpus_in_kielipankki_loc = "";
if (lang == "fi") { corpus_in_kielipankki_loc = "Korpus (Kielipankissa)"; }
else if (lang == "sv") { corpus_in_kielipankki_loc = "Corpus (in Kielipankki) (sv)"; }
else { corpus_in_kielipankki_loc = "Corpus (in Kielipankki)"; }

var persistent_id_metadata_loc = "";
if (lang == "fi") { persistent_id_metadata_loc = "Pysyv채istunniste (metadata)"; }
else if (lang == "sv") { persistent_id_metadata_loc = "Persistent id (metadata) (sv)"; }
else { persistent_id_metadata_loc = "Persistent id (metadata)"; }

var link_to_search_in_korp_loc = "";
if (lang == "fi") { link_to_search_in_korp_loc = "Linkki Korp-hakuun"; }
else if (lang == "sv") { link_to_search_in_korp_loc = "Link to search in Korp (sv)"; }
else { link_to_search_in_korp_loc = "Link to search in Korp"; }

document.write("<p><a href='" + src_url + "'>" + external_media_stream_loc + "</a></p>");
document.write("<p><b>" + corpus_in_kielipankki_loc + ": </b> " + corpusname + "</p>");
document.write("<p><b>" + persistent_id_metadata_loc + ":</b> <a href='http://urn.fi/" + metadata_urn + "'>" + metadata_urn + "</a></p>");
document.write("<p><a href='" + korp_url + "'>" + link_to_search_in_korp_loc + "</a></p>");

var text_session_attributes = "";
if (lang == "fi") { text_session_attributes_loc = "Tekstin attribuutit"; }
else if (lang == "sv") { text_session_attributes_loc ="Text attributes (sv)"; }
else { text_session_attributes_loc = "Text attributes"; };

document.write("<h3>" + text_session_attributes_loc + "</h3>");
document.write("<p><b>" + published_date[0] + ":</b> " + published_date[1] + "</p>");
document.write("<p><b>" + published_time[0] + ":</b> " + published_time[1] + "</p>");
<!-- todo: session duration -->
document.write("</div>")

document.write("</td></tr></table>");

var pausing_function = function(){
var stop_or_continue = document.querySelector("input[name = 'stop_or_continue']:checked").value;
if(this.currentTime >= Number(end_time[1]) && stop_or_continue == "Stop") {
myvideo.pause();}}

myvideo.addEventListener("timeupdate", pausing_function);

jumplink.addEventListener("click", function (event) {
event.preventDefault();
myvideo.play();
myvideo.pause();
myvideo.currentTime = begin_time[1];
myvideo.play();
}, false);

playbutton.addEventListener("click", function () {
    if (myvideo.paused) {
        myvideo.play();
    } else {
        myvideo.pause();
    }
}, false);
</script>

<hr size="3" color="#800080">
</body>
</html>
